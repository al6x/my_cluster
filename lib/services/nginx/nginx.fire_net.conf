upstream app_cluster {
	<% servers.each do |server| %>
	server <%= server %>;
	<% end %>
}


server {
	listen   		   80 default;
	# server_name  localhost;

	access_log  /var/log/nginx/localhost.access.log;

	location / {
		proxy_pass  http://app_cluster;
		
		gzip  on;
    gzip_http_version 1.0;
    gzip_vary on;
    gzip_comp_level 6;
    gzip_proxied any;
    # gzip_types text/plain text/css application/json application/x-javascript text/xml application/xml application/xml+rss text/javascript;
    gzip_buffers 16 8k;
	}

	location /fs/ {
		root   <%= static %>;		
	}
	
	location ~ /[^/]+/static/ {		
		root   <%= static %>;
		
		expires 15m;
		
		gzip  on;
    gzip_http_version 1.0;
    gzip_vary on;
    gzip_comp_level 6;
    gzip_proxied any;
    gzip_types text/plain text/css application/json application/x-javascript text/xml application/xml application/xml+rss text/javascript;
    gzip_buffers 16 8k;
	}
}